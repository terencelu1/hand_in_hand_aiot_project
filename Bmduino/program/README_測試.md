# BMduino 測試腳本說明

## 檔案說明

1. **test_bmduino.py** - 完整測試腳本（推薦）
   - 互動式選單
   - 完整測試功能
   - 統計信息

2. **test_bmduino_simple.py** - 簡單測試腳本
   - 直接監聽數據
   - 可以手動發送命令
   - 適合快速測試

## 安裝依賴

```bash
pip install pyserial
```

## 使用方法

### 方法 1：完整測試腳本

```bash
python test_bmduino.py
```

功能：
- 自動列出可用串口
- 互動式選單選擇測試項目
- 測試待機模式
- 測試工作模式
- 測試接收模式（繼電器控制）
- 顯示統計信息

### 方法 2：簡單測試腳本

```bash
python test_bmduino_simple.py
```

功能：
- 直接監聽所有數據輸出
- 可以手動輸入命令測試繼電器
- 按 Ctrl+C 退出

## 測試步驟

### 1. 準備工作

1. 將 BMduino 的 Native USB 連接到 PC
2. 確認 BMduino 已上傳整合程式
3. 確認所有感測器已正確連接

### 2. 測試待機模式

1. 運行測試腳本
2. 選擇「1. 測試待機模式」
3. 觀察輸出，應該看到：
   ```
   STANDBY,25.50,23.20,72,98
   ```
   格式：`STANDBY,物體溫度,環境溫度,心率,血氧`

### 3. 測試工作模式

1. 選擇「2. 測試工作模式」
2. 將手指放在指紋辨識器上
3. 系統會輸出：`WORKING,START`
4. 將手指放在 MAX30102 上
5. 等待數據穩定後會輸出：
   ```
   WORKING,25.50,23.20,72,98
   ```

### 4. 測試接收模式（繼電器控制）

1. 選擇「3. 測試接收模式」
2. 腳本會自動發送 `RELAY,1` 到 `RELAY,4`
3. 觀察回應：
   - `MODE,RECEIVE` - 進入接收模式
   - `RELAY_OK,1` - 繼電器控制成功
   - `MODE,STANDBY` - 回到待機模式

### 5. 手動測試繼電器（簡單腳本）

在簡單測試腳本中，可以直接輸入：
```
RELAY,1
RELAY,2
RELAY,3
RELAY,4
```

## 預期輸出

### 待機模式
```
[14:30:15] STANDBY,25.50,23.20,72,98
[14:30:16] STANDBY,25.51,23.21,72,98
[14:30:17] STANDBY,25.52,23.22,73,98
```

### 工作模式
```
[14:30:20] WORKING,START
[14:30:23] WORKING,25.50,23.20,72,98
```

### 接收模式
```
[14:30:25] → 發送：RELAY,1
[14:30:25] MODE,RECEIVE
[14:30:26] RELAY_OK,1
[14:30:26] MODE,STANDBY
```

## 故障排除

### 問題：找不到串口
- 檢查 USB 連接
- 確認驅動程式已安裝
- 在裝置管理員中查看 COM 埠

### 問題：沒有數據輸出
- 確認 BMduino 程式已上傳
- 檢查 Native USB 連接
- 確認波特率為 115200

### 問題：工作模式沒有觸發
- 確認指紋已註冊
- 檢查指紋辨識器連接
- 確認指紋辨識器初始化成功

### 問題：繼電器沒有回應
- 檢查命令格式（RELAY,1 到 RELAY,4）
- 確認繼電器連接
- 檢查電源連接

## 注意事項

1. **Windows 兼容性**：腳本已處理 Windows 上的輸入問題
2. **串口權限**：如果無法打開串口，可能需要管理員權限
3. **數據格式**：所有數據以逗號分隔，方便解析
4. **超時處理**：工作模式有 15 秒超時限制

